{% extends 'skeleton.html' %}

{% block title %}Repository list{% endblock %}

{% block content %}

<h2>
  Repositories
  <span>
    (<a href="?by-last-update=yep">order by last update</a>)
  </span>
</h2>
<ul class=repolist>
  {% for repo in repos %}
    <li>
      <a href="{{ url_for('history', repo=repo.name) }}">
        <div class=name>{{ repo.name }}</div>
        {% set description = repo.get_description() %}
        {% if description %}
          <div class=description>{{ description }}</div>
        {% endif %}
      </a>
      {% set readme = repo.get_readme() %}
      {% if readme %}
      <a class="readme-button" id="readme-button-{{ repo.name }}" href="#" onclick="showReadme('{{ repo.name }}');">readme</a>
      {% endif %}
      <div id="{{ repo.name }}-readme" class="readme" style="display: none;">
        {% if readme %}
        <a href="#" onclick="hideReadme('{{ repo.name }}');" style="float: right;">hide readme</a>
        {% if readme['rendered'] %}
        {{ readme['content']|safe }}
        {% else %}
        <pre>{{ readme['content'] }}</pre>
        {% endif %}
        {% endif %}
      </div>
    </li>
  {% endfor %}
</ul>

{% endblock %}
